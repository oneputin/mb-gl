<!doctype html>
<html>
<head>
    <title>routing-tracks demo</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
   
    <!-- web-components applied for app-gui --> 
    <link rel="import" href="../../iron-flex-layout/iron-flex-layout.html">
    <link rel="import" href="../../iron-collapse/iron-collapse.html"><!--  -->
    <!--<link rel="import" href="../../paper-radio-button/paper-radio-button.html"> -->

    <!--<link rel="import" href="../../iron-icons/iron-icons.html">-->
    <link rel="import" href="../icons-svg.html">    
    <link rel="import" href="../../paper-icon-button/paper-icon-button.html">
    <link rel="import" href="../../paper-fab/paper-fab.html">


    <!-- app-components related to map-api --> 
    <link rel="import" href="../mb-target.html">
    
    <link rel="import" href="../mb-api.html">
    <link rel="import" href="../mb-map.html">
    <link rel="import" href="../mb-location-log.html">
    
    <link rel="import" href = "../mb-links-foto.html">
    <link rel="import" href = "../image-card.html">
    
    <custom-style>
        <style is="custom-style">
            
            .container {
                @apply(--layout-horizontal);
                /*align-items: flex-start;*/
            }
            
            .content_area {
                /*width: 60%;*/ 
                top:0; bottom:0;
            }

            .ctrls_area {
                /* itself flex layouted div */
                width: 200px;
                margin-left: 10px;
                @apply(--layout-vertical);
                /*@apply(--layout-start);*/
            }

            mb-map {
                /*width: 55%;*/
                width: 800px;
                height: 670px;
            }
            
            .mapctrls-bottom {
                display: inline-block;
                position: absolute;
                @apply(--layout-horizontal);
                @apply(--layout-center);
                bottom: 12px;
                width: 100%;
            }


            .flexchild {
                @apply(--layout-flex);
            }
            
            mb-content-browser {
                display: inline-block;
                @apply(--layout-vertical);
                @apply(--layout-start);
            }

            mb-links-foto {
                position: absolute;
                top: 0;
                right: 0; 
                z-index: 9;
                padding: 10px;
            }

            #imagecard {
                position: relative;
                display : "block";
                top: 0; left: 0; 
                max-width: 600px;
                /*width : 75% ;*/
                z-index: 9;
                padding: 10px;
            }

            #foto {
                position: absolute;
                background-color: white;
                color: indigo;
                bottom: 20px;
                right: 10px; 
                opacity: 0.8; 
                z-index: 9;
            }

        </style>
    </custom-style>

</head>

<body>

<template is="dom-bind" id="app">

    <div class="container">

        <!-- LEFT block: CONTENT (Map, diagram, list) -->
        <div id="content" class="content_area flexchild">

            <template is="dom-if" if="{{mapstyle}}">
                
                <mb-map 
                    map="{{map}}" 
                    mobilemode = "[[mobilemode]]"
                    mapapikey="[[mbkey]]" 
                    mapstyle="[[mapstyle]]" 
                    mbid="{{mbid}}" 
                    cbox="{{cbox}}" 
                    zoom="{{zoom}}" 
                    mapctrl  = "[[mapctrl]]"
                    maptoast = "[[maptoast]]">

                    <!-- main interface for doc(img)-management -->
                    <mb-links-foto
                        map = "[[map]]"
                        locateflag  = "[[locateflag]]"
                        docselected = "{{docselected}}"
                        linkdocid   = "[[linkdocid]]"
                        clustered   = "{{itemdata}}"
                        toolstatus  = "{{toolstatus}}">
                    </mb-links-foto>    

                    <!-- Formular used to view/manipulate img-meta -->
                    <image-card 
                        id = "imagecard"
                        docobj     = "{{docselected}}" 
                        docobjid   = "{{linkdocid}}" 
                        maplocation = "{{lnglat}}" 
                        locateflag = "{{locateflag}}">
                    </image-card>    
                        <!--itemdata   = "[[itemdata]]" -->
                    
                    <!-- centered target marker, used to geolocate active doc(img) -->
                    <mb-target 
                        mbid = "[[mbid]]"
                        target = "{{target}}"
                        serviceflag="{{locateflag}}">
                    </mb-target>

                    <!-- ??? -->
                    <mb-location-log 
                        checked
                        lnglat="{{lnglat}}" 
                        mbid = "[[mbid]]">
                    </mb-location-log>

                    <!-- FOTO -->
                    <template is="dom-if" if="{{mobilemode}}">
                        <paper-fab 
                            id = "foto" 
                            class = "fab"
                            icon = "app:camera-enhance"
                            title = "foto" 
                            on-tap = "toggleFoto">
                        </paper-fab>
                    </template>

                </mb-map>
                
            </template>    

        </div>
    </div>

</template>

<script>
    // 
    var scope = document.querySelector('#app');

    // scope.mobilemode = (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
    scope.mobilemode = true;
    scope.mbkey = "pk.eyJ1Ijoib25lcHV0aW4iLCJhIjoiY2ltbHBidWxhMDAwa3ZubHdpNHMwdmNwMiJ9.XnPbDF8YdaDgfMFAVi9Vyw";
    scope.mapstyle = 'mapbox://styles/mapbox/light-v9';


    // Map-INIT
    scope.cbox = "13 , 52"; // Berlin
    scope.zoom = 8;

    // SHELL-actions
    scope.mapctrl = {};
    scope.locateflag = false;

    scope.toggleFoto = function(e) {
        console.log("placeholder for fotos"); 
    }

    document.addEventListener('WebComponentsReady', function() {
        console.log("WebComponentsReady"); 

    });

</script>

</body>

</html>